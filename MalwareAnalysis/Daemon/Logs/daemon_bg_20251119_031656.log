[INFO] MemoryDumper imported successfully
[INFO] VolatilityAnalyzer imported successfully
[INFO] MemoryDumper imported successfully
[INFO] VolatilityAnalyzer imported successfully
[WARNING] Enhanced Threat Terminator not available: cannot import name 'EnhancedThreatTerminator' from partially initialized module 'ThreatTerminator.enhanced_threat_terminator' (most likely due to a circular import) (F:\MalwareAnalysis\Daemon\ThreatTerminator\enhanced_threat_terminator.py)
[INFO] Comprehensive Report Generator imported successfully
[INFO] Enhanced Threat Terminator imported successfully
[INFO] Comprehensive Report Generator imported successfully

================================================================================
        [SHIELD] ENHANCED PRE-ANALYZER - CONTINUOUS MONITORING [SHIELD]         
================================================================================

[03:16:56] Initializing enhanced malware detector...
[03:16:56] Loaded 786 whitelisted processes from essential_processes.txt
[03:16:56] Starting continuous monitoring loop
[03:16:56] Press Ctrl+C to stop

 Scan Cycle #1 - 03:16:56 
------------------------
[03:16:57] Scanned 197 processes
[03:16:57] [OK] No threats detected
[03:16:57] Waiting 5 seconds before next scan...

 Scan Cycle #2 - 03:17:02 
------------------------
[03:17:02] Scanned 199 processes
[03:17:02] [OK] No threats detected
[03:17:02] Waiting 5 seconds before next scan...

 Scan Cycle #3 - 03:17:07 
------------------------
[03:17:08] Scanned 199 processes
[03:17:08] [OK] No threats detected
[03:17:08] Waiting 5 seconds before next scan...

 Scan Cycle #4 - 03:17:13 
------------------------
[03:17:13] Scanned 199 processes
[03:17:13] [OK] No threats detected
[03:17:13] Waiting 5 seconds before next scan...

 Scan Cycle #5 - 03:17:18 
------------------------
[03:17:18] Scanned 198 processes
[03:17:18] [OK] No threats detected
[03:17:18] Waiting 5 seconds before next scan...

 Scan Cycle #6 - 03:17:23 
------------------------
[03:17:24] Scanned 198 processes
[03:17:24] [OK] No threats detected
[03:17:24] Waiting 5 seconds before next scan...

 Scan Cycle #7 - 03:17:29 
------------------------
[03:17:29] Scanned 197 processes
[03:17:29] [OK] No threats detected
[03:17:29] Waiting 5 seconds before next scan...

 Scan Cycle #8 - 03:17:34 
------------------------
[03:17:35] Scanned 197 processes
[03:17:35] [OK] No threats detected
[03:17:35] Waiting 5 seconds before next scan...

 Scan Cycle #9 - 03:17:40 
------------------------
[03:17:40] Scanned 197 processes
[03:17:40] [OK] No threats detected
[03:17:40] Waiting 5 seconds before next scan...

 Scan Cycle #10 - 03:17:45 
-------------------------
[03:17:45] Scanned 197 processes
[03:17:45] [OK] No threats detected
[03:17:45] Waiting 5 seconds before next scan...

 Scan Cycle #11 - 03:17:50 
-------------------------
[03:17:51] Scanned 197 processes
[03:17:51] [OK] No threats detected
[03:17:51] Waiting 5 seconds before next scan...

 Scan Cycle #12 - 03:17:56 
-------------------------
[03:17:56] Scanned 197 processes
[03:17:56] [OK] No threats detected
[03:17:56] Waiting 5 seconds before next scan...

 Scan Cycle #13 - 03:18:01 
-------------------------
[03:18:02] Scanned 197 processes
[03:18:02] [OK] No threats detected
[03:18:02] Waiting 5 seconds before next scan...

 Scan Cycle #14 - 03:18:07 
-------------------------
[03:18:07] Scanned 197 processes
[03:18:07] [OK] No threats detected
[03:18:07] Waiting 5 seconds before next scan...

 Scan Cycle #15 - 03:18:12 
-------------------------
[03:18:13] Scanned 202 processes
[03:18:13] [OK] No threats detected
[03:18:13] Waiting 5 seconds before next scan...

 Scan Cycle #16 - 03:18:18 
-------------------------
[03:18:18] Scanned 200 processes
[03:18:18] [OK] No threats detected
[03:18:18] Waiting 5 seconds before next scan...

 Scan Cycle #17 - 03:18:23 
-------------------------
[03:18:24] Scanned 200 processes
[03:18:24] [OK] No threats detected
[03:18:24] Waiting 5 seconds before next scan...

 Scan Cycle #18 - 03:18:29 
-------------------------
[03:18:29] Scanned 201 processes
[03:18:29] 
[CRITICAL THREAT] Initiating automated response...
[03:18:29] Step 1: Suspending process python.exe (PID: 7976)
[ERROR] Failed to suspend python.exe (PID: 7976): (pid=7976)
[03:18:30] Step 2: Quarantining malicious file
[DEBUG] Found script (relative): f:\MalwareAnalysis\ProcessManager\ransomware_test.py
[QUARANTINED] ransomware_test.py -> F:\MalwareAnalysis\Daemon\Quarantine\quarantine_20251119_031830_ransomware_test\ransomware_test.py
[SAFE] File isolated in: F:\MalwareAnalysis\Daemon\Quarantine\quarantine_20251119_031830_ransomware_test
[DELETED] Original file removed: f:\MalwareAnalysis\ProcessManager\ransomware_test.py
[03:18:30] Step 3: Terminating process python.exe (PID: 7976)
[ERROR] Failed to terminate python.exe (PID: 7976): (pid=7976)
[03:18:31] [GRACE PERIOD] python.exe will be skipped for 30s
[03:18:31] [THREAT NEUTRALIZED] python.exe has been suspended, quarantined, and terminated
[03:18:31] Skipping recently terminated threat: python.exe (grace period active)
[03:18:31] Skipping recently terminated threat: python.exe (grace period active)
[03:18:31] Skipping recently terminated threat: python.exe (grace period active)
[03:18:31] [ALERT] THREATS DETECTED: 1

PID      Name                           Threat          Score    Level     
---------------------------------------------------------------------------
7976     python.exe                     RANSOMWARE      80       CRITICAL  
         -> Ransomware keyword: ransomware
         -> Ransomware keyword: ransomware_test
[03:18:31] Report saved: F:\MalwareAnalysis\Daemon\Reports\threats_detected_20251119_031831.json
[03:18:31] 
[MEMORY FORENSICS] Starting memory dump and analysis...
2025-11-19 03:18:31,187 - [INFO] - Memory dumper initialized at F:\MalwareAnalysis\MemoryDumps

================================================================================
[03:18:31] Memory dump error: 'charmap' codec can't encode characters in position 0-1: character maps to <undefined>
[03:18:31] Threat cycle complete! Continuing monitoring...
[03:18:31] 
================================================================================
[03:18:31] Quarantined items: 4
[03:18:31] Auto-delete in 15 seconds if no response...

Delete quarantined files? (y/n): [03:18:46] 
[TIMEOUT] 15-second timeout reached - AUTO-DELETING quarantined files
[03:18:46] [OK] Deleted 4 quarantined item(s)
[03:18:46] ================================================================================

[03:18:46] Waiting 5 seconds before next scan...

 Scan Cycle #19 - 03:18:51 
-------------------------
[03:18:51] Scanned 196 processes
[03:18:51] Skipping recently terminated threat: python.exe (grace period active)
[03:18:51] Skipping recently terminated threat: python.exe (grace period active)
[03:18:51] Skipping recently terminated threat: python.exe (grace period active)
[03:18:51] Skipping recently terminated threat: python.exe (grace period active)
[03:18:51] Skipping recently terminated threat: python.exe (grace period active)
[03:18:51] Skipping recently terminated threat: python.exe (grace period active)
[03:18:51] Skipping recently terminated threat: python.exe (grace period active)
[03:18:51] [ALERT] THREATS DETECTED: 1

PID      Name                           Threat          Score    Level     
---------------------------------------------------------------------------
7976     python.exe                     RANSOMWARE      80       CRITICAL  
         -> Ransomware keyword: ransomware
         -> Ransomware keyword: ransomware_test
[03:18:51] Report saved: F:\MalwareAnalysis\Daemon\Reports\threats_detected_20251119_031851.json
[03:18:51] 
[MEMORY FORENSICS] Starting memory dump and analysis...
2025-11-19 03:18:51,689 - [INFO] - Memory dumper initialized at F:\MalwareAnalysis\MemoryDumps

================================================================================
[03:18:51] Memory dump error: 'charmap' codec can't encode characters in position 0-1: character maps to <undefined>
[03:18:51] Threat cycle complete! Continuing monitoring...
[03:18:51] 
================================================================================
[03:18:51] ================================================================================

[03:18:51] Waiting 5 seconds before next scan...

 Scan Cycle #20 - 03:18:56 
-------------------------
[03:18:57] Scanned 196 processes
[03:18:57] Skipping recently terminated threat: python.exe (grace period active)
[03:18:57] Skipping recently terminated threat: python.exe (grace period active)
[03:18:57] Skipping recently terminated threat: python.exe (grace period active)
[03:18:57] Skipping recently terminated threat: python.exe (grace period active)
[03:18:57] Skipping recently terminated threat: python.exe (grace period active)
[03:18:57] Skipping recently terminated threat: python.exe (grace period active)
[03:18:57] Skipping recently terminated threat: python.exe (grace period active)
[03:18:57] [ALERT] THREATS DETECTED: 1

PID      Name                           Threat          Score    Level     
---------------------------------------------------------------------------
7976     python.exe                     RANSOMWARE      80       CRITICAL  
         -> Ransomware keyword: ransomware
         -> Ransomware keyword: ransomware_test
[03:18:57] Report saved: F:\MalwareAnalysis\Daemon\Reports\threats_detected_20251119_031857.json
[03:18:57] 
[MEMORY FORENSICS] Starting memory dump and analysis...
2025-11-19 03:18:57,059 - [INFO] - Memory dumper initialized at F:\MalwareAnalysis\MemoryDumps

================================================================================
[03:18:57] Memory dump error: 'charmap' codec can't encode characters in position 0-1: character maps to <undefined>
[03:18:57] Threat cycle complete! Continuing monitoring...
[03:18:57] 
================================================================================
[03:18:57] ================================================================================

[03:18:57] Waiting 5 seconds before next scan...

 Scan Cycle #21 - 03:19:02 
-------------------------
[03:19:02] Grace period expired for: python.exe_C:\Users\windows\AppData\Local\Programs\Python\Python313\python.exe
[03:19:02] Scanned 195 processes
[03:19:02] [03:19:02] Error: 'charmap' codec can't encode characters in position 0-1: character maps to <undefined>
Traceback (most recent call last):
  File "F:\MalwareAnalysis\Daemon\enhanced_pre_analyzer_monitor.py", line 1152, in main
    print_status(f"\u26a0\ufe0f  RESPAWNED THREAT DETECTED: {proc['name']} (PID: {proc['pid']}) - Malware is respawning!", "WARNING")
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "F:\MalwareAnalysis\Daemon\enhanced_pre_analyzer_monitor.py", line 1064, in print_status
    print(f"{Fore.WHITE}[{timestamp}] {color}{message}{Style.RESET_ALL}")
    ~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 47, in write
    self.__convertor.write(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 177, in write
    self.write_and_convert(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 202, in write_and_convert
    self.write_plain_text(text, cursor, start)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 210, in write_plain_text
    self.wrapped.write(text[start:end])
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 47, in write
    self.__convertor.write(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 177, in write
    self.write_and_convert(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 205, in write_and_convert
    self.write_plain_text(text, cursor, len(text))
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 210, in write_plain_text
    self.wrapped.write(text[start:end])
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 47, in write
    self.__convertor.write(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 177, in write
    self.write_and_convert(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 205, in write_and_convert
    self.write_plain_text(text, cursor, len(text))
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 210, in write_plain_text
    self.wrapped.write(text[start:end])
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 47, in write
    self.__convertor.write(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 177, in write
    self.write_and_convert(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 205, in write_and_convert
    self.write_plain_text(text, cursor, len(text))
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 210, in write_plain_text
    self.wrapped.write(text[start:end])
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 47, in write
    self.__convertor.write(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 177, in write
    self.write_and_convert(text)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 205, in write_and_convert
    self.write_plain_text(text, cursor, len(text))
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\site-packages\colorama\ansitowin32.py", line 210, in write_plain_text
    self.wrapped.write(text[start:end])
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\windows\AppData\Local\Programs\Python\Python313\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode characters in position 0-1: character maps to <undefined>

 Monitoring Summary 
------------------
[03:19:02] Total cycles completed: 21
[03:19:02] Total threats found: 1
