# Automated Volatility Analyzer - Direct Path Launcher
# Uses full Python path to bypass PATH issues

Write-Host ""
Write-Host "================================================================================" -ForegroundColor Cyan
Write-Host "      AUTOMATED VOLATILITY ANALYZER - DIRECT PATH LAUNCHER" -ForegroundColor Cyan
Write-Host "================================================================================" -ForegroundColor Cyan
Write-Host ""

# Define Python path directly
$PythonPath = "C:\Users\windows\AppData\Local\Programs\Python\Python313\python.exe"

# Check if Python exists
if (-not (Test-Path $PythonPath)) {
    Write-Host "[ERROR] Python not found at: $PythonPath" -ForegroundColor Red
    Write-Host ""
    Write-Host "Please install Python 3.8+ from https://www.python.org/" -ForegroundColor Yellow
    Read-Host "Press Enter to exit"
    exit 1
}

Write-Host "[OK] Python found at: $PythonPath" -ForegroundColor Green
& $PythonPath --version
Write-Host ""

# Check Volatility3 installation
Write-Host "[INFO] Checking Volatility3 installation..." -ForegroundColor Yellow
$volatilityCheck = & $PythonPath -m volatility3 --version 2>&1
if ($LASTEXITCODE -ne 0) {
    Write-Host "[WARNING] Volatility3 not installed" -ForegroundColor Yellow
    Write-Host ""
    Write-Host "[INFO] Installing Volatility3..." -ForegroundColor Cyan
    & $PythonPath -m pip install volatility3
    
    if ($LASTEXITCODE -ne 0) {
        Write-Host "[ERROR] Failed to install Volatility3" -ForegroundColor Red
        Read-Host "Press Enter to exit"
        exit 1
    }
}

Write-Host "[OK] Volatility3 found" -ForegroundColor Green
Write-Host ""

# Check required files
Write-Host "[INFO] Checking required files..." -ForegroundColor Yellow

if (-not (Test-Path "volatility_analyzer.py")) {
    Write-Host "[ERROR] volatility_analyzer.py not found" -ForegroundColor Red
    Write-Host "Please run this script from the VolatilityAnalyzer directory" -ForegroundColor Yellow
    Read-Host "Press Enter to exit"
    exit 1
}

if (-not (Test-Path "analyze_automated.py")) {
    Write-Host "[ERROR] analyze_automated.py not found" -ForegroundColor Red
    Read-Host "Press Enter to exit"
    exit 1
}

Write-Host "[OK] All required files found" -ForegroundColor Green
Write-Host ""

# Run automated analyzer
Write-Host "[INFO] Starting Automated Volatility Analyzer..." -ForegroundColor Cyan
Write-Host "[INFO] This will analyze all dumps in F:\MalwareAnalysis\MemoryDumps\" -ForegroundColor Cyan
Write-Host ""

& $PythonPath analyze_automated.py

if ($LASTEXITCODE -ne 0) {
    Write-Host ""
    Write-Host "[ERROR] Analyzer exited with error code: $LASTEXITCODE" -ForegroundColor Red
    Read-Host "Press Enter to exit"
    exit $LASTEXITCODE
}

Write-Host ""
Write-Host "[OK] Automated analysis completed successfully" -ForegroundColor Green
Write-Host ""
Read-Host "Press Enter to exit"
exit 0
