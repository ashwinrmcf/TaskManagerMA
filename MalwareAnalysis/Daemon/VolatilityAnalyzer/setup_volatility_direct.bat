@echo off
REM Setup Volatility3 - Direct Path Installer
REM Uses full Python path to bypass PATH issues

setlocal enabledelayedexpansion

echo.
echo ================================================================================
echo               VOLATILITY3 SETUP - DIRECT PATH INSTALLER
echo ================================================================================
echo.

REM Define Python path directly
set PYTHON_PATH=C:\Users\windows\AppData\Local\Programs\Python\Python313\python.exe

REM Check if Python exists at this path
if not exist "%PYTHON_PATH%" (
    echo [ERROR] Python not found at: %PYTHON_PATH%
    echo.
    echo Please install Python 3.8+ from https://www.python.org/
    echo.
    pause
    exit /b 1
)

echo [OK] Python found
"%PYTHON_PATH%" --version
echo.

REM Upgrade pip
echo [INFO] Upgrading pip...
"%PYTHON_PATH%" -m pip install --upgrade pip
if errorlevel 1 (
    echo [WARNING] Failed to upgrade pip, continuing anyway...
)

echo.

REM Install volatility3
echo [INFO] Installing Volatility3...
"%PYTHON_PATH%" -m pip install volatility3

if errorlevel 1 (
    echo [ERROR] Failed to install Volatility3
    echo.
    echo Try running this command manually:
    echo   C:\Users\windows\AppData\Local\Programs\Python\Python313\python.exe -m pip install volatility3
    echo.
    pause
    exit /b 1
)

echo.

REM Verify installation
echo [INFO] Verifying Volatility3 installation...
"%PYTHON_PATH%" -m volatility3 --version

if errorlevel 1 (
    echo [ERROR] Volatility3 verification failed
    echo.
    pause
    exit /b 1
)

echo.
echo [OK] Volatility3 installed successfully!
echo.
echo You can now run the automated analyzer:
echo   run_automated_direct.bat
echo.
pause
exit /b 0
