# Automated Volatility Analyzer - PowerShell Launcher
# Non-interactive mode - automatically analyzes all dumps

Write-Host ""
Write-Host "================================================================================" -ForegroundColor Cyan
Write-Host "         AUTOMATED VOLATILITY ANALYZER - NON-INTERACTIVE MODE" -ForegroundColor Cyan
Write-Host "================================================================================" -ForegroundColor Cyan
Write-Host ""

# Check Python installation
Write-Host "[INFO] Checking Python installation..." -ForegroundColor Yellow
$pythonCheck = python --version 2>&1
if ($LASTEXITCODE -ne 0) {
    Write-Host "[ERROR] Python is not installed or not in PATH" -ForegroundColor Red
    Write-Host ""
    Write-Host "SOLUTION: Install Python 3.8+ and add it to your PATH" -ForegroundColor Yellow
    Read-Host "Press Enter to exit"
    exit 1
}

Write-Host "[OK] Python found: $pythonCheck" -ForegroundColor Green
Write-Host ""

# Check Volatility3 installation
Write-Host "[INFO] Checking Volatility3 installation..." -ForegroundColor Yellow
$volatilityCheck = python -m volatility3 --version 2>&1
if ($LASTEXITCODE -ne 0) {
    Write-Host "[WARNING] Volatility3 not installed" -ForegroundColor Yellow
    Write-Host ""
    Write-Host "[INFO] Installing Volatility3..." -ForegroundColor Cyan
    pip install volatility3
    
    if ($LASTEXITCODE -ne 0) {
        Write-Host "[ERROR] Failed to install Volatility3" -ForegroundColor Red
        Read-Host "Press Enter to exit"
        exit 1
    }
}

Write-Host "[OK] Volatility3 found" -ForegroundColor Green
Write-Host ""

# Check required files
Write-Host "[INFO] Checking required files..." -ForegroundColor Yellow

if (-not (Test-Path "volatility_analyzer.py")) {
    Write-Host "[ERROR] volatility_analyzer.py not found" -ForegroundColor Red
    Write-Host "Please run this script from the VolatilityAnalyzer directory" -ForegroundColor Yellow
    Read-Host "Press Enter to exit"
    exit 1
}

if (-not (Test-Path "analyze_automated.py")) {
    Write-Host "[ERROR] analyze_automated.py not found" -ForegroundColor Red
    Read-Host "Press Enter to exit"
    exit 1
}

Write-Host "[OK] All required files found" -ForegroundColor Green
Write-Host ""

# Run automated analyzer
Write-Host "[INFO] Starting Automated Volatility Analyzer..." -ForegroundColor Cyan
Write-Host "[INFO] This will analyze all dumps in F:\MalwareAnalysis\MemoryDumps\" -ForegroundColor Cyan
Write-Host ""

python analyze_automated.py

if ($LASTEXITCODE -ne 0) {
    Write-Host ""
    Write-Host "[ERROR] Analyzer exited with error code: $LASTEXITCODE" -ForegroundColor Red
    Read-Host "Press Enter to exit"
    exit $LASTEXITCODE
}

Write-Host ""
Write-Host "[OK] Automated analysis completed successfully" -ForegroundColor Green
Write-Host ""
Read-Host "Press Enter to exit"
exit 0
