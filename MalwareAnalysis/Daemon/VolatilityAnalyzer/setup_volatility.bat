@echo off
REM Setup Volatility3 - Install required dependencies

setlocal enabledelayedexpansion

echo.
echo ================================================================================
echo                    VOLATILITY3 SETUP - DEPENDENCY INSTALLER
echo ================================================================================
echo.

REM Check if Python is installed
python --version >nul 2>&1
if errorlevel 1 (
    echo [ERROR] Python is not installed or not in PATH
    echo.
    echo Please install Python 3.8+ from https://www.python.org/
    echo Make sure to check "Add Python to PATH" during installation
    echo.
    pause
    exit /b 1
)

echo [OK] Python found
python --version
echo.

REM Upgrade pip
echo [INFO] Upgrading pip...
python -m pip install --upgrade pip
if errorlevel 1 (
    echo [WARNING] Failed to upgrade pip, continuing anyway...
)

echo.

REM Install volatility3
echo [INFO] Installing Volatility3...
pip install volatility3

if errorlevel 1 (
    echo [ERROR] Failed to install Volatility3
    echo.
    echo Try running this command manually:
    echo   pip install volatility3
    echo.
    pause
    exit /b 1
)

echo.

REM Verify installation
echo [INFO] Verifying Volatility3 installation...
python -m volatility3 --version

if errorlevel 1 (
    echo [ERROR] Volatility3 verification failed
    echo.
    pause
    exit /b 1
)

echo.
echo [OK] Volatility3 installed successfully!
echo.
echo You can now run the automated analyzer:
echo   python analyze_automated.py
echo.
pause
exit /b 0
