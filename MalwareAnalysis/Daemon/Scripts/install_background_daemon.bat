@echo off
REM Install Process Daemon as Windows Service (runs in background)

echo.
echo ================================================================
echo           üõ°Ô∏è  INSTALLING BACKGROUND DAEMON SERVICE
echo ================================================================
echo.
echo This will install the daemon to run silently in background
echo and start automatically at boot.
echo.
echo After installation:
echo   ‚Ä¢ Daemon runs 24/7 in background
echo   ‚Ä¢ Monitors for threats continuously
echo   ‚Ä¢ Tray app shows notifications
echo   ‚Ä¢ Close CMD window - daemon keeps running!
echo.
pause

REM Check for admin rights
net session >nul 2>&1
if %errorLevel% == 0 (
    echo Administrator privileges confirmed.
) else (
    echo Requesting administrator privileges...
    powershell -Command "Start-Process cmd -ArgumentList '/c \"%~f0\"' -Verb RunAs"
    exit /b
)

cd /d "F:\MalwareAnalysis\ProcessManager"
set PYTHON_EXE=C:\Users\windows\AppData\Local\Programs\Python\Python313\python.exe

echo.
echo üöÄ Installing daemon service...
echo.

REM Install the daemon service
"%PYTHON_EXE%" process_daemon_service.py install

if %errorLevel% == 0 (
    echo.
    echo ‚úÖ Service installed successfully!
    echo.
    echo üîß Configuring automatic startup...
    
    REM Start the service
    "%PYTHON_EXE%" process_daemon_service.py start
    
    echo.
    echo ‚úÖ Daemon service is now running in background!
    echo.
    echo üéØ What happens now:
    echo    ‚Ä¢ Daemon runs silently 24/7
    echo    ‚Ä¢ Automatically starts at boot
    echo    ‚Ä¢ Monitors for threats continuously
    echo    ‚Ä¢ Tray app shows notifications
    echo    ‚Ä¢ Close CMD - daemon keeps running!
    echo.
    echo üìã To view daemon activity:
    echo    ‚Ä¢ Right-click tray icon
    echo    ‚Ä¢ Process Daemon ‚Üí View Daemon Console
    echo.
    echo üõë To stop daemon:
    echo    ‚Ä¢ Right-click tray icon
    echo    ‚Ä¢ Process Daemon ‚Üí Stop Daemon Service
    echo.
) else (
    echo.
    echo ‚ùå Installation failed!
    echo.
)

pause
