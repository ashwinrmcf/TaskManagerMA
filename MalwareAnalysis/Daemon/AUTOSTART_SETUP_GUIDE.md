# ðŸš€ Auto-Start Setup Guide - Start Daemon on PC Boot

## What is Auto-Start?

**Auto-Start** = Daemon automatically starts when you turn on your PC

No need to manually run the daemon every time - it starts automatically!

---

## Quick Setup (2 Steps)

### Step 1: Open PowerShell as Administrator

1. Press `Windows Key + X`
2. Select **Windows PowerShell (Admin)**
3. Click **Yes** when prompted

### Step 2: Run Setup Script

Copy and paste this command:
```powershell
F:\MalwareAnalysis\Daemon\setup_autostart.ps1
```

Press Enter and wait for completion.

**That's it!** âœ…

---

## What Happens Next

### After Setup
- âœ… Daemon will start automatically on PC boot
- âœ… New window opens titled "Malware Analysis Daemon"
- âœ… Monitoring begins immediately
- âœ… No manual action needed

### When You Restart PC
```
1. PC boots
2. Windows loads
3. You log in
4. Daemon starts automatically
5. Monitoring begins
```

---

## How It Works

### Two Methods Used

#### Method 1: Startup Folder Shortcut
- Location: `C:\Users\YourName\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`
- File: `Start_Malware_Daemon.lnk`
- Runs when: You log in to Windows

#### Method 2: Windows Registry
- Location: `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`
- Entry: `MalwareAnalyzerDaemon`
- Runs when: You log in to Windows

**Both methods ensure reliable auto-start**

---

## Verification

### Check if Setup Worked

#### Method 1: Check Startup Folder
```
C:\Users\[YourName]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\
```

Look for: `Start_Malware_Daemon.lnk`

#### Method 2: Check Registry
1. Press `Windows Key + R`
2. Type: `regedit`
3. Navigate to: `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`
4. Look for: `MalwareAnalyzerDaemon`

#### Method 3: Restart and Observe
1. Restart your PC
2. After login, look for "Malware Analysis Daemon" window
3. If window appears, auto-start is working âœ…

---

## Disabling Auto-Start

### If You Want to Stop Auto-Start

Run this command in PowerShell (as Administrator):
```powershell
F:\MalwareAnalysis\Daemon\disable_autostart.ps1
```

This will:
- âœ“ Remove startup shortcut
- âœ“ Remove registry entry
- âœ“ Daemon will NOT start automatically

---

## Manual Start (Without Auto-Start)

If you disable auto-start, manually start with:

```powershell
python F:\MalwareAnalysis\Daemon\enhanced_pre_analyzer_monitor.py
```

Or use the batch file:
```
F:\MalwareAnalysis\Daemon\start_daemon_on_startup.bat
```

---

## Troubleshooting

### Problem: Setup Script Won't Run

**Error**: "cannot be loaded because running scripts is disabled"

**Solution**:
1. Open PowerShell as Administrator
2. Run this command:
   ```powershell
   Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
   ```
3. Type `Y` and press Enter
4. Try setup again

---

### Problem: Daemon Doesn't Start on Boot

**Cause**: Setup didn't complete or script path wrong

**Solution**:
1. Run setup script again
2. Make sure you're Administrator
3. Check if shortcut exists in Startup folder
4. Restart PC and wait 30 seconds

---

### Problem: Daemon Starts But Closes Immediately

**Cause**: Python not installed or path wrong

**Solution**:
1. Verify Python is installed: `python --version`
2. Check daemon path exists: `F:\MalwareAnalysis\Daemon\enhanced_pre_analyzer_monitor.py`
3. Try running manually first to see error message

---

### Problem: Want to Change Auto-Start Behavior

**Option 1**: Run as Minimized
Edit `start_daemon_on_startup.bat`:
```batch
start "Malware Analysis Daemon" /min python enhanced_pre_analyzer_monitor.py
```

**Option 2**: Run in Background
Edit `start_daemon_on_startup.bat`:
```batch
start "" /b python enhanced_pre_analyzer_monitor.py
```

**Option 3**: Run with Delay
Edit `start_daemon_on_startup.bat`:
```batch
timeout /t 10
start "Malware Analysis Daemon" python enhanced_pre_analyzer_monitor.py
```

---

## Files Involved

### Setup Files
```
F:\MalwareAnalysis\Daemon\
â”œâ”€â”€ setup_autostart.ps1 (Enable auto-start)
â”œâ”€â”€ disable_autostart.ps1 (Disable auto-start)
â”œâ”€â”€ start_daemon_on_startup.bat (Startup script)
â””â”€â”€ AUTOSTART_SETUP_GUIDE.md (This file)
```

### System Files Created
```
C:\Users\[YourName]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\
â””â”€â”€ Start_Malware_Daemon.lnk (Shortcut)

Registry:
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
â””â”€â”€ MalwareAnalyzerDaemon (Entry)
```

---

## FAQ

### Q: Will this slow down my PC startup?
**A**: No, the daemon runs in background. Startup time not affected.

### Q: Can I close the daemon window?
**A**: Yes, but it will stop monitoring. To keep it running, minimize instead.

### Q: What if I want to run it only sometimes?
**A**: Disable auto-start and run manually when needed.

### Q: Does it require admin rights?
**A**: Yes, the setup script needs admin rights. The daemon itself needs admin to terminate processes.

### Q: Can multiple daemons run?
**A**: Not recommended. Only one instance should run at a time.

### Q: How do I know if it's running?
**A**: Look for "Malware Analysis Daemon" window in taskbar.

### Q: What if I restart Windows?
**A**: Daemon will start automatically again after login.

### Q: Can I run it on a schedule?
**A**: Yes, use Windows Task Scheduler instead of auto-start.

---

## Advanced: Task Scheduler (Alternative)

If you prefer Task Scheduler instead of auto-start:

### Create Scheduled Task

1. Press `Windows Key + R`
2. Type: `taskschd.msc`
3. Click **Create Task** on right panel
4. Name: `Malware Analysis Daemon`
5. Check: **Run with highest privileges**
6. Go to **Triggers** tab
7. Click **New**
8. Select: **At log on**
9. Click **OK**
10. Go to **Actions** tab
11. Click **New**
12. Program: `python`
13. Arguments: `F:\MalwareAnalysis\Daemon\enhanced_pre_analyzer_monitor.py`
14. Start in: `F:\MalwareAnalysis\Daemon`
15. Click **OK** and **OK**

---

## Summary

| Aspect | Details |
|--------|---------|
| **Setup Time** | 1 minute |
| **Methods** | 2 (Startup folder + Registry) |
| **Admin Required** | Yes |
| **Startup Time Impact** | None |
| **Can Disable** | Yes, anytime |
| **Manual Start** | Still possible |
| **Reliability** | Very high |

---

## Next Steps

1. âœ… Run setup script
2. âœ… Restart PC
3. âœ… Verify daemon starts
4. âœ… Monitor for threats

**Auto-start is now active!** ðŸš€

---

**Version**: 1.0  
**Status**: Ready to Use âœ…
