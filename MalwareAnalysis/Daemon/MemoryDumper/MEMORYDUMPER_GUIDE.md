# üíæ Memory Dumper - Snapshot Creator Guide

## What is Memory Dumper?

**Memory Dumper** creates a snapshot of a suspicious program's memory.

Think of it like taking a photograph of what a criminal was doing at the moment of arrest - the evidence is frozen in time.

---

## Why Memory Dumps Matter

### What's in Memory?
When a program runs, it stores in memory:
- Data it's processing
- Passwords and encryption keys
- Network connections
- Files it's accessing
- Code it's executing
- Stolen information

### Why Analyze It?
- Shows what malware was actually doing
- Reveals hidden code and injections
- Finds stolen data
- Identifies command & control servers
- Proves malicious intent

---

## How It Works

### Step 1: Identify Target
```
Threat detected: python.exe (RANSOMWARE, Score: 80)
‚Üí Memory Dumper selected for analysis
```

### Step 2: Prepare System
```
Creating targeted kernel dump (2-4GB)...
```

### Step 3: Capture Memory
```
Dump progress: 100/3072MB (3.3%)
Dump progress: 307/3072MB (10.0%)
Dump progress: 614/3072MB (20.0%)
...
Dump progress: 3070/3072MB (99.9%)
```

### Step 4: Save Dump
```
Kernel memory captured: F:\MalwareAnalysis\MemoryDumps\TargetedDumps\
TargetedKernelDump_python.exe_20251125_140641.raw
```

### Step 5: Create Metadata
```
Metadata saved: F:\MalwareAnalysis\MemoryDumps\dump_metadata_20251125_140641.json
```

---

## Dump Strategies

Memory Dumper chooses the best strategy based on threat type:

### üîµ Full System Dump
- **Size**: 8GB+ (entire RAM)
- **Time**: 30-60 seconds
- **Use Case**: Critical ransomware, worms
- **Benefit**: Complete system state

### üü¢ Targeted Kernel Dump
- **Size**: 2-4GB
- **Time**: 10-30 seconds
- **Use Case**: Most threats (default)
- **Benefit**: Balanced size and detail

### üü° Process-Specific Dump
- **Size**: 100-500MB
- **Time**: 5-10 seconds
- **Use Case**: Single suspicious process
- **Benefit**: Fast and focused

### üü† Minimal Forensic Dump
- **Size**: 50-100MB
- **Time**: 2-5 seconds
- **Use Case**: Quick analysis needed
- **Benefit**: Very fast

### üî¥ Live Response Dump
- **Size**: Variable
- **Time**: 1-2 seconds
- **Use Case**: C2 communication threats
- **Benefit**: Captures network state

---

## Understanding the Output

### Countdown
```
‚è≥ Initiating memory dump in 5 seconds...

Countdown:
  [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë] 1s remaining...
```
**Meaning**: Preparing to capture memory

### Progress Bar
```
[14:06:42] Dump progress: 100/3072MB (3.3%)
[14:06:42] Dump progress: 200/3072MB (6.5%)
[14:06:42] Dump progress: 300/3072MB (9.8%)
```
**Meaning**: Capturing memory in progress

### Completion
```
[14:06:53] Kernel memory captured: F:\MalwareAnalysis\MemoryDumps\TargetedDumps\
TargetedKernelDump_python.exe_20251125_140641.raw
[14:06:53] Memory dump completed for python.exe
```
**Meaning**: Dump successfully created

---

## Dump Files

### Where Dumps Are Stored
```
F:\MalwareAnalysis\MemoryDumps\
‚îú‚îÄ‚îÄ FullSystemDumps/
‚îú‚îÄ‚îÄ TargetedDumps/
‚îú‚îÄ‚îÄ ProcessDumps/
‚îú‚îÄ‚îÄ MinimalDumps/
‚îú‚îÄ‚îÄ LiveResponse/
‚îî‚îÄ‚îÄ AnalysisResults/
```

### File Naming
```
TargetedKernelDump_python.exe_20251125_140641.raw
                    ‚Üë              ‚Üë
                Process Name    Timestamp
```

### File Size
- **Full System**: 8GB+
- **Targeted Kernel**: 2-4GB
- **Process Specific**: 100-500MB
- **Minimal**: 50-100MB

---

## Dump Metadata

### What's Recorded
```json
{
  "threat_name": "python.exe",
  "threat_type": "RANSOMWARE",
  "threat_level": "CRITICAL",
  "risk_score": 80,
  "dump_type": "targeted_kernel",
  "dump_file": "TargetedKernelDump_python.exe_20251125_140641.raw",
  "dump_size_mb": 3072,
  "timestamp": "2025-11-25T14:06:41",
  "duration_seconds": 12
}
```

### Why It Matters
- Tracks which threat created which dump
- Records dump strategy used
- Timestamps for correlation
- Size information for cleanup

---

## Dump Cleanup

### Automatic Cleanup
After analysis, old dumps are automatically deleted:

```
‚úì DELETED: TargetedDumps/TargetedKernelDump_python.exe_20251125_140531.raw (2904.0MB)
‚úì DELETED: TargetedDumps/TargetedKernelDump_python.exe_20251120_223634.raw (3072.0MB)
‚úì DELETED: MinimalDumps/MinimalDump_python_20251118_224145.raw (100.0MB)

Cleanup Summary:
  Dumps Deleted: 20
  Space Freed: 6676.6MB
```

### Cleanup Rules
- ‚úÖ Keeps latest dump
- ‚úÖ Deletes older dumps
- ‚úÖ Frees disk space
- ‚úÖ Preserves analysis results

### Manual Cleanup
To manually delete dumps:
```powershell
Remove-Item "F:\MalwareAnalysis\MemoryDumps\TargetedDumps\*" -Recurse
```

---

## Performance Impact

### During Dump Creation
- **CPU**: 20-40% (reading memory)
- **Disk I/O**: High (writing 2-4GB)
- **Memory**: Minimal (dump is streamed)
- **Time**: 10-30 seconds

### After Dump Creation
- **CPU**: Back to normal
- **Disk**: 2-4GB used (temporary)
- **Memory**: Released

### System Responsiveness
- System remains responsive
- Other programs continue running
- Dump happens in background

---

## Troubleshooting

### Problem: Dump Takes Too Long

**Cause**: Slow disk or large memory

**Solution**:
1. Check disk speed (SSD vs HDD)
2. Close other disk-intensive programs
3. Use Minimal dump strategy

### Problem: Not Enough Disk Space

**Cause**: Multiple dumps accumulate

**Solution**:
1. Cleanup old dumps manually
2. Increase disk space
3. Use smaller dump strategy

### Problem: Dump Creation Fails

**Cause**: Permission issues or memory pressure

**Solution**:
1. Run as Administrator
2. Close memory-intensive programs
3. Check disk space

---

## Dump Analysis Workflow

```
Threat Detected
    ‚Üì
Memory Dumped (2-4GB)
    ‚Üì
Volatility Analysis (44 commands)
    ‚Üì
Evidence Extracted
    ‚Üì
Report Generated
    ‚Üì
Old Dumps Deleted
    ‚Üì
System Cleaned
```

---

## Best Practices

### ‚úÖ Do
- Let dumps complete fully
- Don't interrupt dump process
- Allow cleanup to run
- Monitor disk space

### ‚ùå Don't
- Manually delete active dumps
- Interrupt dump creation
- Fill disk with old dumps
- Ignore cleanup warnings

---

## Storage Requirements

### Disk Space Needed
- **Minimum**: 10GB free
- **Recommended**: 20GB free
- **Optimal**: 50GB free

### Why So Much?
- Full System Dump: 8GB
- Targeted Dump: 4GB
- Analysis Results: 1GB
- Reports: 100MB

---

## Summary

| Aspect | Details |
|--------|---------|
| **Purpose** | Capture memory snapshot |
| **Dump Size** | 50MB - 8GB |
| **Dump Time** | 2-60 seconds |
| **Strategies** | 5 different types |
| **Storage** | F:\MalwareAnalysis\MemoryDumps\ |
| **Cleanup** | Automatic (keeps latest) |
| **Disk Impact** | 2-4GB temporary |
| **CPU Impact** | 20-40% during dump |

---

**Version**: 1.0  
**Status**: Production Ready ‚úÖ
