#!/bin/bash
# Volatility Analysis Script
# Generated: 2025-11-25T14:16:20.519403
# Threat: python.exe (ransomware)
# Level: CRITICAL
# Strategy: targeted_kernel

DUMP_FILE="F:\MalwareAnalysis\MemoryDumps\TargetedDumps\TargetedKernelDump_python.exe_20251125_141610.raw"
PROFILE="Win1064"
OUTPUT_DIR="./analysis_results"

mkdir -p $OUTPUT_DIR

echo "Starting volatility analysis..."
echo "Dump: $DUMP_FILE"
echo "Profile: $PROFILE"
echo ""

echo '[1/11] Running: volatility -f dump.raw imageinfo'
volatility -f dump.raw imageinfo > $OUTPUT_DIR/result_01.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_01.txt'

echo '[2/11] Running: volatility -f dump.raw modules'
volatility -f dump.raw modules > $OUTPUT_DIR/result_02.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_02.txt'

echo '[3/11] Running: volatility -f dump.raw modscan'
volatility -f dump.raw modscan > $OUTPUT_DIR/result_03.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_03.txt'

echo '[4/11] Running: volatility -f dump.raw ssdt'
volatility -f dump.raw ssdt > $OUTPUT_DIR/result_04.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_04.txt'

echo '[5/11] Running: volatility -f dump.raw getsids'
volatility -f dump.raw getsids > $OUTPUT_DIR/result_05.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_05.txt'

echo '[6/11] Running: volatility -f dump.raw driverirp'
volatility -f dump.raw driverirp > $OUTPUT_DIR/result_06.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_06.txt'

echo '[7/11] Running: volatility -f dump.raw idt'
volatility -f dump.raw idt > $OUTPUT_DIR/result_07.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_07.txt'

echo '[8/11] Running: volatility -f dump.raw gdt'
volatility -f dump.raw gdt > $OUTPUT_DIR/result_08.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_08.txt'

echo '[9/11] Running: volatility -f dump.raw malfind'
volatility -f dump.raw malfind > $OUTPUT_DIR/result_09.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_09.txt'

echo '[10/11] Running: volatility -f dump.raw pslist'
volatility -f dump.raw pslist > $OUTPUT_DIR/result_10.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_10.txt'

echo '[11/11] Running: volatility -f dump.raw handles'
volatility -f dump.raw handles > $OUTPUT_DIR/result_11.txt 2>&1
echo 'Results saved to $OUTPUT_DIR/result_11.txt'


echo "Analysis complete!"
echo "Results saved to $OUTPUT_DIR"
