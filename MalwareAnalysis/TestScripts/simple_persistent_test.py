#!/usr/bin/env python3
"""
SIMPLE PERSISTENT SUSPICIOUS PROCESS - Guaranteed to stay alive
This runs forever until killed by the malware analysis system.
"""

import time
import socket
import threading
import os
import random

class SimplePersistentMalware:
    def __init__(self):
        self.running = True
        print("ðŸš¨" * 50)
        print("ðŸš¨ SIMPLE PERSISTENT MALWARE SIMULATION STARTED")
        print("ðŸš¨ Process name: suspicious_malware.exe")
        print("ðŸš¨ This process will run FOREVER until terminated")
        print("ðŸš¨ CPU usage: HIGH")
        print("ðŸš¨ Network activity: SUSPICIOUS")
        print("ðŸš¨ File activity: MALICIOUS")
        print("ðŸš¨" * 50)

    def malicious_activity(self):
        """Continuous malicious activity"""
        while self.running:
            try:
                # High CPU usage
                for _ in range(100000):
                    x = random.randint(1, 1000000) * random.randint(1, 1000)
                
                # Create suspicious files
                try:
                    os.makedirs("f:/MalwareAnalysis/TestScripts/malware_files", exist_ok=True)
                    with open("f:/MalwareAnalysis/TestScripts/malware_files/keylogger.exe", "w") as f:
                        f.write("MALICIOUS KEYLOGGER DATA\n")
                    with open("f:/MalwareAnalysis/TestScripts/malware_files/backdoor.dll", "w") as f:
                        f.write("BACKDOOR PAYLOAD\n")
                except:
                    pass
                
                print(f"ðŸš¨ [MALWARE] ACTIVE - PID: {os.getpid()} - High CPU/Network Activity")
                time.sleep(10)  # Activity every 10 seconds
                
            except Exception as e:
                print(f"ðŸš¨ [MALWARE] Error in activity: {e}")
                time.sleep(5)

    def run_forever(self):
        """Main persistent loop - runs forever"""
        print("ðŸš¨ [MALWARE] Starting persistent malicious activity...")
        
        # Start malicious activity in background
        activity_thread = threading.Thread(target=self.malicious_activity, daemon=False)
        activity_thread.start()
        
        # Main infinite loop - this ensures process stays alive
        counter = 0
        try:
            while True:
                counter += 1
                print(f"ðŸš¨ [PERSISTENT-MALWARE] RUNTIME: {counter * 30} seconds - STATUS: ACTIVE")
                print(f"ðŸš¨ [PERSISTENT-MALWARE] PID: {os.getpid()} - STILL RUNNING")
                print(f"ðŸš¨ [PERSISTENT-MALWARE] This process should appear as SUSPICIOUS")
                print("=" * 70)
                
                time.sleep(30)  # Report every 30 seconds
                
        except KeyboardInterrupt:
            print("ðŸš¨ [MALWARE] Process interrupted - terminating")
            self.running = False
        except Exception as e:
            print(f"ðŸš¨ [MALWARE] Unexpected error: {e}")
            print("ðŸš¨ [MALWARE] Continuing anyway...")
            time.sleep(5)

if __name__ == "__main__":
    print("ðŸ”¥" * 60)
    print("ðŸ”¥ LAUNCHING PERSISTENT MALWARE SIMULATION")
    print("ðŸ”¥ This process will run INDEFINITELY")
    print("ðŸ”¥ Use Task Manager or Process Manager to kill it")
    print("ðŸ”¥" * 60)
    
    malware = SimplePersistentMalware()
    malware.run_forever()
