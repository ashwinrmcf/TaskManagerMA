@echo off
REM Install startup shortcut for daemon and tray app

echo.
echo ================================================================
echo          Installing Auto-Start Shortcut
echo ================================================================
echo.

REM Get Windows Startup folder path
set STARTUP_FOLDER=%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup

REM Create shortcut using PowerShell
powershell -Command ^
  "$WshShell = New-Object -ComObject WScript.Shell; " ^
  "$Shortcut = $WshShell.CreateShortcut('%STARTUP_FOLDER%\Process Manager Daemon.lnk'); " ^
  "$Shortcut.TargetPath = 'F:\MalwareAnalysis\ProcessManager\startup_daemon_and_tray.bat'; " ^
  "$Shortcut.WorkingDirectory = 'F:\MalwareAnalysis\ProcessManager'; " ^
  "$Shortcut.Description = 'Process Manager Daemon and Tray - Auto-start'; " ^
  "$Shortcut.Save()"

if %errorlevel% equ 0 (
    echo.
    echo ✓ Shortcut installed successfully!
    echo.
    echo Location: %STARTUP_FOLDER%\Process Manager Daemon.lnk
    echo.
    echo At next system boot:
    echo   - Background daemon will start (minimized)
    echo   - Tray app will start (visible)
    echo   - System will be protected automatically
    echo.
) else (
    echo.
    echo ✗ Failed to install shortcut
    echo.
)

pause
