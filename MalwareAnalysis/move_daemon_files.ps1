# Move essential daemon files to Daemon folder
$sourceDir = "f:\MalwareAnalysis\ProcessManager"
$targetDir = "f:\MalwareAnalysis\Daemon"

# Create target directory if it doesn't exist
if (-not (Test-Path $targetDir)) {
    New-Item -ItemType Directory -Path $targetDir -Force | Out-Null
}

# Core daemon files
$daemonFiles = @(
    "process_daemon_console.py",
    "process_daemon_service.py",
    "process_manager_tray.py",
    "process_daemon.py",
    "install_daemon_service.py"
)

# Daemon startup scripts
$startupScripts = @(
    "startup_daemon_and_tray.bat",
    "run_daemon_background.bat",
    "start_daemon_console.bat",
    "install_background_daemon.bat"
)

# Daemon configuration files
$configFiles = @(
    "essential_processes.txt",
    "daemon_notifications.json",
    "file_deletion_notifications.json"
)

# Documentation
$docFiles = @(
    "BACKGROUND_DAEMON_README.md",
    "DAEMON_CONSOLE_README.md",
    "SERVICE_README.md"
)

# Executable tools
$exeFiles = @(
    "procdump.exe",
    "winpmem_mini.exe",
    "winpmem_mini_x64_rc2.exe"
)

# Combine all files to move
$allFiles = $daemonFiles + $startupScripts + $configFiles + $docFiles + $exeFiles

# Move files
foreach ($file in $allFiles) {
    $sourcePath = Join-Path $sourceDir $file
    $targetPath = Join-Path $targetDir $file
    
    if (Test-Path $sourcePath) {
        Write-Host "Moving: $file"
        Move-Item -Path $sourcePath -Destination $targetPath -Force
    } else {
        Write-Host "Not found: $file"
    }
}

# Move Icons folder
$sourceIcons = Join-Path $sourceDir "Icons"
$targetIcons = Join-Path $targetDir "Icons"

if (Test-Path $sourceIcons) {
    Write-Host "Moving: Icons folder"
    if (Test-Path $targetIcons) {
        Remove-Item $targetIcons -Recurse -Force
    }
    Move-Item -Path $sourceIcons -Destination $targetIcons -Force
}

Write-Host "Daemon files migration complete!"
Write-Host "Files moved to: $targetDir"
